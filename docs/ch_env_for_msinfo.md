このページでは質量分析データをインフォマティクスで解析するために有益な情報に関して、主に解析環境に関して記述します。



# はじめに
質量分析装置にはたいていベンダーが作成したソフトウェアが付いてくると思います。分析データを閲覧するためのviewerや、定量解析をするための解析ツールや化合物同定のツールもあると思います。
それらは使いやすい一方で、データ解析の自由度が必ずしも高くなかったり、実際のデータ処理の中身が分かりずらかったりと、必ずしも使っていて”楽しい”ものではないかもしれません。
また、インストールできるPCの数がライセンスで決まっていたりと、別の現実的な問題があるかもしれません。

従来の特定のターゲット化合物だけを定量する、というようなアプリケーションではそのようなツールでも問題はなかったかもしれませんが、
スループット性が上がり、ノンターゲット分析の重要度が増している近年では、膨大な分析データを目的に応じて処理・解析する上でベンダーのソフトウェアでは対応しきれない場面というのが出てきていると思います。

このような背景から、質量分析データを扱い・解析する上で、ベンダーのソフトウェアに縛られず、自由な解析を行うための環境構築を独自で行うことが重要であると考えています（勧めています）。

このチャプターではそのような独自の解析用の環境構築のヒント・きっかけになるような情報を提供することを目的としています。
また、ここで紹介する環境・ツール・言語は管理者の経験や環境に基づいてお勧めするものであり、誰にとってもベストなものというわけではありません。
独自の解析環境の構築が意外と簡単であること、興味が湧いたときにとりあえず手を付けてみるための情報、といったものの提供が目的になります。


# プログラミングかワークフローか
データ解析環境、というのは非常にあいまいな表現です。コンピューターでデータを解析する方法としては大体以下の2つが真っ先に思いつくかもしれません。

- (A) データを既存のソフトウェア・ツールで処理し、出力を他のソフトウェアで処理、（繰り返し）
- (B) プログラミングにより、データ処理プロセスを一から記述する（コーディング）

Aは例えばベンダーのソフトウェアの出力をエクセルで処理する、といった流れです。もちろんAとBの組み合わせもあり得ます。
このAとBの間には大きなプログラミングという大きな壁が存在していて、それが現在いわゆる質量分析インフォマティクス人口が少ない一因ではないかと思います。

それに対して、第３の選択肢としてはワークフロー（パイプライン）作りが挙げられると思います。
バイオインフォマティクス分野ではGalaxyというシステム、より一般的なデータサイエンス分野ではKNIMEが有名です。
簡単に言ってしまうと、元のデータに対して様々な処理法がモジュールとして存在しており、それをつなげることで複雑なデータ処理を自動化するというしくみです（モジュールをつなげるという意味ではパイプライン作りという呼び方がしっくりきます）。プログラミングというと黒い画面に長いコードを打ち込んで・・・というイメージをお持ちの方が多いかもしれませんが、このようなワークフロー作りではGUI上でモジュール間を線でつなげるだけでOKです。

# どっちを選ぶ？
コーディングによるプログラミングととワークフロー作り、どちらを選ぶかはなかなか難しい問題ではあります。

- コーディングとかプログラミング言語なんて無理 or GUIがないと頭が働かない　=>　ワークフロー作り 
- プログラミングに興味がある　=>　コーディング 
- 長期的にインフォマティクス関係も取り組みたい　=>　コーディング
- ちょっとしたデータ処理を自動化してみたいだけ　=>　ワークフロー作り 

ただ、ワークフロー作りは視覚的に分かりやすくはあるのですが、各モジュールの仕様が分かりにくく使用しにくいケースがあったり、
ループ・分岐構造が直感的に分かりにくいことがあったり、と実際にやや複雑なデータ処理フローをつくるときに寧ろ難しいと感じることは結構あります。
また、一般的なプログラミング言語であれば分析化学以外の多方面でも活用できるケースは多々あると思うので、「技術が身につく」ということになると思います。


# 質量分析データ解析ライブラリ
ベンダーのソフトウェアからなかなか離れられない一つの原因は質量分析のデータ解析のスタート地点が質量分析装置が吐き出すrawデータ（生データ）であり、ここからデータ読む方法が思いつかない・面倒ということがあるのではないかと思います。これは必ずしも比較定量や未知化合物のアノテーションといった高度な解析ではなく、単にLC-MSデータをTICクロマトグラムで見てみる、スタンダードのXICを書いてみる、という日常的な操作ですらベンダーのソフトウェアがないと出来ない・面倒というふうに考えているかもしれません。逆に、rawデータから容易に自分の欲しい情報を得ることができれば、データ解析の自由度はずっと高くなるはずです。

前置きが長くなりましたが、そのような質量分析データの基本的な操作を行うライブラリがOpenMSになります。（https://www.openms.de/）
各社の装置のRawデータの読み込み自体はベンダーのdllファイルやライブラリが必要にはなりますが、それさえインストールすればrawデータからデータの読み込み、ピーク検出、アライメント、比較定量、といった質量分析によく使われるデータ処理がすべて網羅されています。

ライブラリのコアはC++で書かれていますが、Pythonから直に使えるpyOpenMSがあり、コーディング目的ではPythonから使うのがお勧めです。
また、コーディングを行わずに、前述のワークフローとしてもKNIME, Galaxy上で利用することが可能です。


（以降準備中です）
